<h1 class="building-index-h1">All tasks</h1>

<% if current_user.renter == false %>
  <% @tasks.each do |task| %>
    <div class="card-product-s">
      <div class="card-product-infos">
        <div class="task-line-one">
          <div class="task-label">
            <p>Task</p>
          </div>
          <p>
            <%= task.title %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Status</p>
          </div>
          <p>
            <% if task.status == false %>
              Incomplete
            <% else %>
              Complete
            <% end %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Urgency</p>
          </div>
          <p>
            <%= task.urgency %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Renter:
              <% if task.unit.user != nil %>
                <%= task.unit.user.first_name %><%= task.unit.user.last_name %>
              <% end %>
            </p>
          </div>
          <p>
            <%= task.unit_id %>
          </p>
        </div>
      </div>
      <% if task.status == false %>
        <div class="task-middle-s">
          <div class="card-title-top">
            <h2><%= task.building.address %> -
              <% if task.unit.unit_number? %>
                <%= task.unit.unit_number %>
              <% end %>
            </h2>
            <p><%= task.created_at %></p>
          </div>
          <div class="task-description">
            <div class="task-description-s">
              <p>Description: <%= task.description  %></p>
            </div>
          </div>
        </div>
        <div class="right-side-card">
          <div class="edit-status">
            <button class="btn btn-success btn-sm" id="task-complete">
              <%= link_to "Mark task as complete", update_status_task_path(task), method: :patch %>
            </button>
            <a href="<%= edit_task_path(task) %>">
              <i class="fas fa-pencil-alt"></i>
            </a>
          </div>
          <div class="img-s">
             <% if task.photos.exists? %>
              <% task.photos.each do |photo| %>
                <%= cl_image_tag photo.key, height:200 %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>

<% else %>

    <% @tasks.each do |task| %>
    <div class="card-product-s">
      <div class="card-product-infos">
        <div class="task-line-one">
          <div class="task-label">
            <p>Task</p>
          </div>
          <p>
            <%= task.title %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Status</p>
          </div>
          <p>
            <% if task.status == false %>
              Incomplete
            <% else %>
              Complete
            <% end %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Urgency</p>
          </div>
          <p>
            <%= task.urgency %>
          </p>
        </div>
        <div class="task-line-one">
          <div class="task-label">
            <p>Renter</p>
          </div>
          <p>
            <%= task.unit_id %>
          </p>
        </div>
      </div>
      <% if task.status == false %>
        <div class="task-middle-s">
          <div class="card-title-top">
            <h2>Building - Unit</h2>
            <p><%= task.created_at %></p>
          </div>
          <div class="task-description-s">
              <p>Description</p>
            <p>
              <%= task.description %>
            </p>
          </div>
        </div>
        <div class="right-side-card">
          <div class="img-s">
            <% if task.photos.exists? %>
              <% task.photos.each do |photo| %>
                <%= cl_image_tag photo.key, height:200 %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
<% end %>
